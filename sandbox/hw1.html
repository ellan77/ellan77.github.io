<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hw1-react</title>
  </head>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    .container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #box {
      height: 400px;
      width: 400px;
      /* background-color: #e3e3e3; */
      box-shadow: 5px 5px 5px 2px #eee;
    }
    .image {
      width: 100%;
    }
    .description {
      font-size: 14px;
    }
    .title {
      color: #fb6600;
      font-weight: 700;
      font-size: 18px;
    }
    .toggle {
      margin-bottom: 10px;
      display: block;
      color: #fb6600;
      /* padding-top: 15px; */
      text-decoration: none;
    }
  </style>
  <body>
    <div class="container">
      <div id="box"></div>
    </div>
    <script>
      class View {
        //Create all elements
        constructor() {
          this.app = document.getElementById("box");

          this.item = 0;
          this.toggleMode = false;

          this.img = this.createElement("img", "image");
          this.title = this.createElement("div", "title");
          this.desc = this.createElement("p", "description");
          this.toggle = this.createElement("a", "toggle");
          this.toggle.textContent = "Toggle";
          this.toggle.setAttribute("href", "#");
          this.but1 = this.createElement("button");
          this.but2 = this.createElement("button");
          this.but3 = this.createElement("button");
          this.but4 = this.createElement("button");
          this.but1.textContent = "<<<";
          this.but2.textContent = "<";
          this.but3.textContent = ">";
          this.but4.textContent = ">>>";

          this.app.append(this.img);
          this.app.append(this.title);
          this.app.append(this.desc);
          this.app.append(this.toggle);
          this.app.append(this.but1);
          this.app.append(this.but2);
          this.app.append(this.but3);
          this.app.append(this.but4);
        }

        //Util method
        createElement(elementTag, elementClass) {
          const element = document.createElement(elementTag);
          if (elementClass) {
            element.classList.add(elementClass);
          }
          return element;
        }
      }

      class Box extends View {
        constructor() {
          super();

          this.dataLoad();

          //Buttons Action Listener
          this.but1.addEventListener("click", () => this.setItem(0));
          this.but2.addEventListener("click", () =>
            this.setItem((this.item -= 1))
          );
          this.but3.addEventListener("click", () =>
            this.setItem((this.item += 1))
          );
          this.but4.addEventListener("click", () =>
            this.setItem(this.count - 1)
          );
          this.toggle.addEventListener("click", () => {
            if (!this.toggleMode) {
              this.desc.textContent = this.description;
              console.log(this.toggleMode);
            } else {
              this.desc.textContent = this.description.slice(0, 52) + "...";
              console.log(this.toggleMode);
            }
            this.toggleMode = !this.toggleMode;
          });
        }

        //Change item
        setItem(item) {
          if (item < 0) item = this.count - 1;
          if (item > this.count - 1) item = 0;
          this.item = item;
          this.dataLoad();
        }

        async dataLoad() {
          return await fetch(
            "https://my-json-server.typicode.com/IlyaLytvynov/ads-box-server/ads"
          ).then(res => {
            if (res.ok) {
              res.json().then(res => {
                // this.view.box(res[item]);
                this.count = Object.keys(res).length;
                this.img.setAttribute("src", res[this.item].img);
                this.title.textContent = res[this.item].title;
                this.description = res[this.item].description;
                this.desc.textContent = this.description.slice(0, 52) + "...";
              });
            } else {
              console.log("sorry data didn't loaded");
            }
          });
        }
      }
      new Box();
    </script>
  </body>
</html>
